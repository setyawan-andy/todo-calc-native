{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport firebase from \"firebase\";\nimport \"@firebase/firestore\";\nvar firebaseConfig = {\n  apiKey: \"AIzaSyD3oizpB1yWu1PgoFjrJax6Z2eqOOLx-6s\",\n  authDomain: \"todoways-17.firebaseapp.com\",\n  projectId: \"todoways-17\",\n  storageBucket: \"todoways-17.appspot.com\",\n  messagingSenderId: \"571027244358\",\n  appId: \"1:571027244358:web:405a49ad31728524235147\"\n};\n\nvar Fire = function () {\n  function Fire(callback) {\n    _classCallCheck(this, Fire);\n\n    this.init(callback);\n  }\n\n  _createClass(Fire, [{\n    key: \"init\",\n    value: function init(callback) {\n      if (!firebase.apps.length) {\n        firebase.initializeApp(firebaseConfig);\n      }\n\n      firebase.auth().onAuthStateChanged(function (user) {\n        if (user) {\n          callback(null, user);\n        } else {\n          firebase.auth().signInAnonymously().catch(function (error) {\n            callback(error);\n          });\n        }\n      });\n    }\n  }, {\n    key: \"getLists\",\n    value: function getLists(callback) {\n      var ref = this.ref.orderBy('name');\n      this.unsubscribe = ref.onSnapshot(function (snapshot) {\n        lists = [];\n        snapshot.forEach(function (doc) {\n          lists.push(_objectSpread({\n            id: doc.id\n          }, doc.data()));\n        });\n        callback(lists);\n      });\n    }\n  }, {\n    key: \"addList\",\n    value: function addList(list) {\n      var ref = this.ref;\n      ref.add(list);\n    }\n  }, {\n    key: \"updateList\",\n    value: function updateList(list) {\n      var ref = this.ref;\n      ref.doc(list.id).update(list);\n    }\n  }, {\n    key: \"deleteList\",\n    value: function deleteList(list) {\n      var ref = this.ref;\n      ref.doc(list.id).delete();\n    }\n  }, {\n    key: \"userId\",\n    get: function get() {\n      return firebase.auth().currentUser.uid;\n    }\n  }, {\n    key: \"ref\",\n    get: function get() {\n      return firebase.firestore().collection('users').doc(this.userId).collection(\"lists\");\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.unsubscribe();\n    }\n  }]);\n\n  return Fire;\n}();\n\nexport default Fire;","map":{"version":3,"sources":["/Users/andysetyawan/Documents/bootcamp-dw/week4/todoApps-v1/Fire.js"],"names":["firebase","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","Fire","callback","init","apps","length","initializeApp","auth","onAuthStateChanged","user","signInAnonymously","catch","error","ref","orderBy","unsubscribe","onSnapshot","snapshot","lists","forEach","doc","push","id","data","list","add","update","delete","currentUser","uid","firestore","collection","userId"],"mappings":";;;;;;;;AAAA,OAAOA,QAAP,MAAqB,UAArB;AACA,OAAO,qBAAP;AAGA,IAAMC,cAAc,GAAG;AACnBC,EAAAA,MAAM,EAAE,yCADW;AAEnBC,EAAAA,UAAU,EAAE,6BAFO;AAGnBC,EAAAA,SAAS,EAAE,aAHQ;AAInBC,EAAAA,aAAa,EAAE,yBAJI;AAKnBC,EAAAA,iBAAiB,EAAE,cALA;AAMnBC,EAAAA,KAAK,EAAE;AANY,CAAvB;;IAQMC,I;AAEF,gBAAYC,QAAZ,EAAqB;AAAA;;AACjB,SAAKC,IAAL,CAAUD,QAAV;AACH;;;;WAED,cAAKA,QAAL,EAAc;AACV,UAAG,CAACT,QAAQ,CAACW,IAAT,CAAcC,MAAlB,EAAyB;AACrBZ,QAAAA,QAAQ,CAACa,aAAT,CAAuBZ,cAAvB;AACH;;AAEDD,MAAAA,QAAQ,CAACc,IAAT,GAAgBC,kBAAhB,CAAmC,UAAAC,IAAI,EAAI;AACvC,YAAGA,IAAH,EAAQ;AACJP,UAAAA,QAAQ,CAAC,IAAD,EAAOO,IAAP,CAAR;AACH,SAFD,MAEO;AACHhB,UAAAA,QAAQ,CAACc,IAAT,GAAgBG,iBAAhB,GAAoCC,KAApC,CAA0C,UAAAC,KAAK,EAAI;AAC/CV,YAAAA,QAAQ,CAACU,KAAD,CAAR;AACH,WAFD;AAGH;AACJ,OARD;AASH;;;WAED,kBAASV,QAAT,EAAmB;AACf,UAAIW,GAAG,GAAG,KAAKA,GAAL,CAASC,OAAT,CAAiB,MAAjB,CAAV;AAEA,WAAKC,WAAL,GAAmBF,GAAG,CAACG,UAAJ,CAAe,UAAAC,QAAQ,EAAI;AAC1CC,QAAAA,KAAK,GAAG,EAAR;AAEAD,QAAAA,QAAQ,CAACE,OAAT,CAAiB,UAAAC,GAAG,EAAI;AACpBF,UAAAA,KAAK,CAACG,IAAN;AAAaC,YAAAA,EAAE,EAAEF,GAAG,CAACE;AAArB,aAA4BF,GAAG,CAACG,IAAJ,EAA5B;AACH,SAFD;AAIArB,QAAAA,QAAQ,CAACgB,KAAD,CAAR;AACH,OARkB,CAAnB;AASH;;;WAED,iBAAQM,IAAR,EAAc;AACV,UAAIX,GAAG,GAAG,KAAKA,GAAf;AAEAA,MAAAA,GAAG,CAACY,GAAJ,CAAQD,IAAR;AACH;;;WAED,oBAAWA,IAAX,EAAiB;AACb,UAAIX,GAAG,GAAG,KAAKA,GAAf;AAEAA,MAAAA,GAAG,CAACO,GAAJ,CAAQI,IAAI,CAACF,EAAb,EAAiBI,MAAjB,CAAwBF,IAAxB;AACH;;;WAED,oBAAWA,IAAX,EAAgB;AACZ,UAAIX,GAAG,GAAG,KAAKA,GAAf;AACAA,MAAAA,GAAG,CAACO,GAAJ,CAAQI,IAAI,CAACF,EAAb,EAAiBK,MAAjB;AACH;;;SAED,eAAa;AACT,aAAOlC,QAAQ,CAACc,IAAT,GAAgBqB,WAAhB,CAA4BC,GAAnC;AACH;;;SAED,eAAU;AACN,aAAOpC,QAAQ,CAACqC,SAAT,GAAqBC,UAArB,CAAgC,OAAhC,EAAyCX,GAAzC,CAA6C,KAAKY,MAAlD,EAA0DD,UAA1D,CAAqE,OAArE,CAAP;AACH;;;WAED,kBAAS;AACL,WAAKhB,WAAL;AACH;;;;;;AAGL,eAAed,IAAf","sourcesContent":["import firebase from \"firebase\";\nimport \"@firebase/firestore\";\n\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyD3oizpB1yWu1PgoFjrJax6Z2eqOOLx-6s\",\n    authDomain: \"todoways-17.firebaseapp.com\",\n    projectId: \"todoways-17\",\n    storageBucket: \"todoways-17.appspot.com\",\n    messagingSenderId: \"571027244358\",\n    appId: \"1:571027244358:web:405a49ad31728524235147\",\n}\nclass Fire {\n\n    constructor(callback){\n        this.init(callback)\n    }\n\n    init(callback){\n        if(!firebase.apps.length){\n            firebase.initializeApp(firebaseConfig)\n        }\n\n        firebase.auth().onAuthStateChanged(user => {\n            if(user){\n                callback(null, user)\n            } else {\n                firebase.auth().signInAnonymously().catch(error => {\n                    callback(error)\n                });\n            }\n        });\n    }\n\n    getLists(callback) {\n        let ref = this.ref.orderBy('name');\n\n        this.unsubscribe = ref.onSnapshot(snapshot => {\n            lists = [];\n\n            snapshot.forEach(doc => {\n                lists.push({ id: doc.id, ...doc.data() });\n            });\n            \n            callback(lists);\n        });\n    }\n\n    addList(list) {\n        let ref = this.ref;\n\n        ref.add(list);\n    }\n\n    updateList(list) {\n        let ref = this.ref;\n        \n        ref.doc(list.id).update(list);\n    }\n\n    deleteList(list){\n        let ref = this.ref;\n        ref.doc(list.id).delete()\n    };\n\n    get userId() {\n        return firebase.auth().currentUser.uid\n    }\n\n    get ref() {\n        return firebase.firestore().collection('users').doc(this.userId).collection(\"lists\");\n    }\n\n    detach() {\n        this.unsubscribe();\n    }\n}\n\nexport default Fire;\n"]},"metadata":{},"sourceType":"module"}